"use strict";var fdScripts={stripString:function(t,e){var a=t.indexOf(e);return-1!==a?t.slice(0,a)+t.substr(a+e.length):t},truncateString:function(t,e){var a=t.indexOf(e);return-1!==a?t.slice(0,a):t},getJSON:function(t,e){$.ajax({url:t,type:"GET",dataType:"json",success:e,error:function(t){console.log("Ajax Error: %s",t)}})},gaTrack:function(t,e,a,i,r){window.ga&&(void 0!==r?window.ga("send","event",t,e,a,i,r):void 0!==i?window.ga("send","event",t,e,a,i):window.ga("send","event",t,e,a))}};$(function(){Detectizr.detect({detectScreen:!1}),Handlebars.registerHelper("is_release",function(t,e){return 0===t.indexOf("Released ")&&"The CI Bot"===e?" fd-release-commit":"fd-commit"}),Handlebars.registerHelper("strip_sign",function(t,e){var a=fdScripts.truncateString(t,"Signed-off-by:");return a=fdScripts.stripString(a,"[skip ci]"),a=fdScripts.stripString(a,"[ci skip]"),a=(a=fdScripts.stripString(a,"[deploy]")).length>e-1?a.slice(0,e)+"...":a}),Handlebars.registerHelper("format_date",function(t){return new Date(t).toLocaleDateString()}),Handlebars.registerHelper("format_date_time",function(t){var e=new Date(t);return e.toLocaleDateString()+" "+e.toLocaleTimeString()}),Handlebars.registerHelper("fix_github_url",function(t){if(!t)return t;var e=t.replace("https://api.github.com/users/","https://github.com/");return(e=e.replace("https://api.github.com/repos/","https://github.com/")).replace("/commits/","/commit/")});var d=Detectizr.os.name,c='fdScripts.gaTrack("Files", "Download", "flickr downloadr %PLATFORM% (downloads)");',t=$("#social-icons"),f={installerPath:"/installer/linux-x64/flickrdownloadr_%VERSION%-0_amd64.deb",installerFile:"flickrdownloadr_%VERSION%-0_amd64.deb"},m={installerPath:"/installer/linux-x64/flickrdownloadr-%VERSION%-0.x86_64.rpm",installerFile:"flickrdownloadr-%VERSION%-0.x86_64.rpm"},u={windows:{name:"Windows",commonName:"Windows",shortName:"win",iconName:"fa-windows",installerPath:"/installer/windows/flickrdownloadr-%VERSION%-windows-installer.exe",installerFile:"flickrdownloadr-%VERSION%-windows-installer.exe"},osx:{name:"Mac OS X",commonName:"Mac OS X",shortName:"osx",iconName:"fa-apple",installerPath:"/installer/osx/Install flickr downloadr (v%VERSION%).dmg",installerFile:"Install flickr downloadr (v%VERSION%).dmg"},linux:{name:"Linux",commonName:"Linux",shortName:"linux",iconName:"fa-linux",installerPath:"/installer/linux/flickrdownloadr-%VERSION%-linux-installer.run",installerFile:"flickrdownloadr-%VERSION%-linux-installer.run"},"linux-x64":{name:"64-bit Linux",commonName:"Linux",shortName:"linux",iconName:"fa-linux",installerPath:"/installer/linux-x64/flickrdownloadr-%VERSION%-linux-x64-installer.run",installerFile:"flickrdownloadr-%VERSION%-linux-x64-installer.run"}},e={facebook:{title:"Like us on Facebook",href:"https://www.facebook.com/flickrdownloadr"},flickr:{title:"Follow us on flickr",href:"http://www.flickr.com/photos/_floydpink_"},gmail:{title:"Send us an email",href:"mailto:contact.us@flickrdownloadr.com"},"google+":{title:"Follow us on Google+",href:"https://plus.google.com/u/0/112082983921398252462/about"},pinterest:{title:"Follow us on Pinterest",href:"http://pinterest.com/flickrdownloadr/"},twitter:{title:"Follow us on Twitter",href:"https://twitter.com/FlickrDownloadr"},youtube:{title:"Follow us on YouTube",href:"http://www.youtube.com/user/flickrdownloadr"},github:{title:"Fork us on GitHub",href:"https://github.com/flickr-downloadr"}};t.find("a").each(function(){var t=$(this).attr("class");$(this).attr("target","_blank").attr("onclick","fdScripts.gaTrack('External', 'Click', 'Social ("+t+")');"),$(this).attr("title",e[t].title).attr("href",e[t].href),"gmail"===t&&$(this).attr("target","_self")}),"linux"===d&&"64bit"===Detectizr.os.addressRegisterSize?d="linux-x64":"android"===d||"blackberry"===d?d="linux":"mac os"!==d&&"ios"!==d||(d="osx"),$.get("/build.number",function(r){var a=$(".fd-version");$(".fd-version-text").text(r),$(".fd-version-quote").fadeIn();var t=u[d];t||(t=u.windows,d="windows");var e=$("#fd-download-button");e.attr("onClick",'fdScripts.gaTrack("Files", "Download", "flickr downloadr %PLATFORM% (home)");'.replace("%PLATFORM%",t.name)),e.attr("href",t.installerPath.replace("%VERSION%",r)),$("#fd-download-platform-name").text(t.name),$("#fd-download-platform-icon").addClass(t.iconName),$("#fd-installer").fadeIn(),$.each(["windows","osx","linux","linux-x64"],function(t,e){var a=u[e];$("#fd-installer-"+e+"-file").text(decodeURIComponent(a.installerFile.replace("%VERSION%",r)));var i=$("#fd-installer-download-"+e+"-button");i.attr("onClick",c.replace("%PLATFORM%",a.name)),i.attr("href",a.installerPath.replace("%VERSION%",r))}),$("#fd-installer-deb-file").text(f.installerFile.replace("%VERSION%",r));var i=$("#fd-installer-deb");i.attr("onClick",c.replace("%PLATFORM%","linux-deb")),i.attr("href",f.installerPath.replace("%VERSION%",r)),$("#fd-installer-rpm-file").text(m.installerFile.replace("%VERSION%",r));var n=$("#fd-installer-rpm");n.attr("onClick",c.replace("%PLATFORM%","linux-rpm")),n.attr("href",m.installerPath.replace("%VERSION%",r)),$("#fd-installer-download-"+d+"-button").removeClass("btn-warning").addClass("btn-success"),$('a[href="#fd-installer-'+t.shortName+'"]').tab("show"),$("#fd-installer-section-column").fadeIn();var l=$("#fd-hidden-slides"),o=$(".fd-screenshots-carousel"),s=$("#fd-screenshot-header-platform");s.find("span").text(t.commonName),s.find("a").on("click",function(){return o.find(".carousel-inner").append(l.find(".item").detach()),o.find(".carousel-inner").find(".item").each(function(){var t,e=$(this);e.hasClass("win")?t=" (Windows)":e.hasClass("osx")?t=" (Mac OS X)":e.hasClass("linux")&&(t=" (Linux)"),e.find("h4").text(e.find("h4").text()+t)}),s.fadeOut(),!1}),"win"!==t.shortName&&(l.append(o.find(".win.item").detach()),l.find(".item").removeClass("active"),o.find(".carousel-inner").append(l.find("."+t.shortName+".item").detach()),o.find(".item").first().addClass("active")),fdScripts.getJSON("https://api.github.com/repos/flickr-downloadr/flickr-downloadr-gtk/git/refs/tags/v"+r,function(t){fdScripts.getJSON("https://api.github.com/repos/flickr-downloadr/flickr-downloadr-gtk/git/tags/"+t.object.sha,function(t){var e=$("<abbr></abbr>").attr("title",t.tagger.date).text(" ("+new Date(t.tagger.date).toLocaleDateString()+")").addClass("timeago");a.append($("<span></span>").addClass("fd-released").append($("<span></span>").text(" - ")).append(e)),$("abbr.timeago").timeago()})})}),$(document).on("click","#getCommits",function(){$("#commitsContainer").empty().append($('<div><span class="muted">Loading...</span></div>')),fdScripts.getJSON("https://api.github.com/repos/flickr-downloadr/flickr-downloadr-gtk/commits",function(t){var e={commitsarray:t},a=Handlebars.compile("<table> <thead>   <th class='fd-commitmessage'>Message</th>   <th class='fd-commitname'>Author</th>   <th class='fd-commitdate'>Date</th> </thead> <tbody> {{#commitsarray}}   <tr class='{{is_release commit.message commit.author.name}}'>     <td class='fd-commitmessage'>       <span>{{strip_sign commit.message 40}}</span>       <span>         <a href='{{fix_github_url url}}' title='{{format_date_time commit.author.date}}' target='_blank'> &raquo;</a>       </span>     </td>     <td class='fd-commitname'>       <a href='{{fix_github_url author.url}}' target='_blank'>{{strip_sign commit.author.name 15}}</a>     </td>     <td class='fd-commitdate'>       <abbr class='timeago' title='{{commit.author.date}}'>{{format_date commit.author.date}}</abbr>     </td>   </tr> {{/commitsarray}} </tbody></table>")(e);$("#commitsContainer").empty().append(a),$("abbr.timeago").timeago()})}),$("#fd-slideshow-dialog").find("img").wrap(function(){return'<a href="'+$(this).attr("src")+'" target="_blank" title="Click to see actual size" />'})});